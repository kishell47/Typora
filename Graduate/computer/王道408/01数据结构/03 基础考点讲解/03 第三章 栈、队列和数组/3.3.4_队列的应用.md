# 队列的应用



## 队列应用一一树的层次遍历

* 树这种数据结构是分层的

  * 比如这是第一层，这是第二层，然后这是第三层，这是第四层
  * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211532381.png" alt="image-20230421153248293" style="zoom: 50%;" />

* **层次遍历**

  * 层次遍历就是指你一层一层的来遍历这些树里边的各个节点
  * 要实现这种层次遍历，就需要一个队列的辅助

* **层次遍历的大致思想**

  * 先新建一个队列

  * 然后从这个根结点出发，按层次来遍历各个节点

  * 那首先被遍历的应该是根结点，也就是1号结点

  * 在遍历到1号节点的时候，就需要把这个节点的左右两个孩子节点都放到队列的队尾，左孩子是2号右孩子是3号

    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211548384.png" alt="image-20230421154810311" style="zoom: 50%;" />

  * 遍历完了1号节点之后，它就可以出队，我们就可以从队列当中删除1号节点

  * 接下来应该检查的就是队头结点也就是2号节点

  * 同样的也需要把2号结点的左右两个孩子加入队列的队尾，所以左孩子是4，右孩子是5，那我们就把它们都连到这队列里边

    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211552453.png" alt="image-20230421155212375" style="zoom:50%;" />

  * 处理完2号节点之后，同样的2号节点就可以出队了

  * 接下来需要处理的是3号节点和刚才一样，3号结点的左孩子和右孩子都需要加入队列，那左孩子是6，右孩子是7，所以把6号和7号结点都放到队列的队尾

    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211555532.png" alt="image-20230421155523465" style="zoom:50%;" />

  * 接下来3号孩子出队，接下来应该遍历到4号节点

  * 但是由于4号结点没有左右孩子，所以不需要在队尾当中插入任何元素，就可以直接让4号结点出队。

    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211557418.png" alt="image-20230421155724346" style="zoom:50%;" />

  * 接下来处理的是5号结点，那五号结点的左右孩子分别是8和9都需要把它连到队列的队尾

    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211601489.png" alt="image-20230421160134396" style="zoom:50%;" />

  * 同样的删除5号节结点，再往后是6号结点，那6号结点也没有左右孩子，那也可以让6号结点直接出队。

  * 最后是7号结点，那7号结点的左右孩子分别是10和11，这两个结点处理完，7号之后就可以让他出队，之后的处理都是一样的.

  * 按层次遍历的这种顺序，每处理一个结点的时候都需要把这个结点的左右孩子放到队列的队尾，而每一次遍历处理的应该是队头的那个元素，所以我们用一个队列就可以辅助的完成对树的层次遍历。

    

## 队列应用一一图的广度优先遍历

* 图的广度优先遍历也需要队列这种数据结构的支持。
* 实现的思想和树的遍历是很类似的。
  * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211717924.png" alt="image-20230421171751802" style="zoom: 50%;" />
* 假设我们从这个1号结点出发，来按广度优先的方式遍历这个图里边的各个结点。
* 那首先就是需要新建一个队列。
* 刚开始要遍历的是1号结点
* 那当我们遍历一个结点的时候，就需要检查和这个结点相邻的其它结点有没有被遍历过
* 现在2号和3号这两个结点都没有被遍历过，所以可以把它们放到这个队列的队尾
* 处理完1号节点之后，就可以让它出队
* 接下来要处理的是2号结点，要检查和2号相邻的结点中有没有还没有被处理过的结点，显然1号结点已经被处理过，所以不需要把1号结点放到队列的队尾，而4号是没有处理过的，所以我们需要把4号放到它的队尾。
* 接下来2号就可以出队，再往后遍历到3号节点，那同样的和3号结点相邻的这些结点当中，1号已经被处理过，然后5、6号是没有被遍历过，没有被处理过的，所以把5、6号放到这个队列的队尾。然后三号就遍历结束
* 接下来要处理4号结点，显然和4号相邻的结点都已经被处理过，所以四号结点可以直接出队。
* 接下来处理5号，那么和5号相邻，并且没有被遍历，没有被处理的，应该是7号和8号结点，那同样的我们把它加入到这个队列的队尾，那后续的遍历中就不会再加入任何一个结点，所以直到整个队列为空的时候，我们就完成了对这个图的广度优先。
  * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211719473.png" alt="image-20230421171905363" style="zoom:50%;" />



## 队列在操作系统中的应用

* 操作系统需要管理系统当中的一些硬件资源，比如说CPU，还有某些IO设备之类的。但是这些系统资源往往都是有限的。而我们的系统当中，同时会有多个进程并发的运行，这些进程都会争抢的来使用这些系统资源，那操作系统是如何分配系统资源的呢？

* 一个很常用的策略就是`先来先服务（FCFS：First Come First Service）`的策略，就是哪个进程先申请系统资源，我就先把这个资源分配给那个进程。那先来先服务的思想是不是和队列的先进先出是一样的?

* 因此，要实现先来先服务的这种管理策略，其实一般都是是要用一个队列来辅助完成

* **例1：CPU资源分配**

  * 比如说CPU资源其实是有限的，但是你的系统中可能会同时启动了多个进程。

  * 那操作系统会让这些进程排成一个所谓的就绪队列，然后每一次选择队头元素，让它上CPU执行一个比较短的时间片。然后迅速的下CPU，接下来让下一个进程上CPU运行，运行小段时间之后又让它下CPU。这样循环往复，那这样的话，所有的这些进程都可以轮流的得到CPU的服务

    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211729222.png" alt="image-20230421172929074" style="zoom:50%;" />

    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211730722.png" alt="image-20230421173019612" style="zoom:50%;" />

  * 所以为什么你的电脑只有一个CPU，但是可以有那么多的程序同时的运行，这背后其实离不开操作系统的一些管理策略的支持，而这种先来先服务的策略，通常都需要队列这种数据结构的支持。

* **例2：打印数据缓冲区**
  * 场景：去学校打印店打印论文，多个同学用同一台打印机打印，打印的先后顺序如何？
  *  学校打印店很多时候都是多台电脑连同一台打印机的，也就多个同学可以同时使用一台打印机来打印他们想要的东西，那你会发现当打印机还在工作的时候，其实你就已经可以按下打印按钮了。这是因为系统开辟了一片缓冲区，用来存放此时打印机暂时还不能处理的数据
    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211737040.png" alt="image-20230421173752781" style="zoom: 33%;" />
  * 比如说此时有一个同学，他在打印自己的论文，那这个论文很长。那当这个论文在打印的过程中，其他人其实就可以陆续的提交自己的这个打印请求，系统会在背后把这些打印数据按照先来后到的这样的原则，把它们组织成一个队列。
    * <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211740888.png" alt="image-20230421174054725" style="zoom:50%;" />
  * 然后接下来按照队列先进先出（FIFO）的原则。从这个队列中依次取出打印的数据，然后让打印机打印输出。所以在这个场景中，用一个队列把这些暂时不能被处理的任务给组织起来，这样的话就可以从一定程度上缓解我们主机和打印机速度不匹配的问题
    * ![image-20230421174411480](https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202304211744614.png)
  * 因为打印机是一个慢速设备，但是我们的电脑主机是很快速的设备，可以在短时间内发出大量的打印任务，而打印机又处理不了，怎么办呢？就把这些需要打印的数据放到缓冲区里，那比较合理的方式就是可以用队列把这些数据给组织起来.