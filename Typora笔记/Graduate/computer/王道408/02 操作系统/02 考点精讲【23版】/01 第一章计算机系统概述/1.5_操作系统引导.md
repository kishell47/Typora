# 操作系统引导（Boot）



## 知识总览

<img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202305101633283.png" alt="image-20230510163309146" style="zoom:50%;" />

* 什么是操作系统的引导，简单来说， 就是当你在开机的时候。 如何让操作系统在你的电脑上运行起来，这就是操作系统引导做的事情，为了解释清楚这个问题，首先会介绍在磁盘里边有哪些和操作系统引导相关的数据，了解了这些内容之后，再来介绍操作系统引导的具体过程。 

  

## 一个刚买来的磁盘（硬盘）

<img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202305101637589.png" alt="image-20230510163702470" style="zoom:50%;" />

* 首先来看一下磁盘里边有哪些数据，如果你花钱买了一个新的磁盘，那么这个磁盘的内部刚开始就像你的钱包一样都是空空的。 
* 接下来作为计算机专业的同学都应该有能力把一个新的磁盘给安装到电脑主板上，接下来就可以在这个磁盘里边去安装操作系统了



## 安装操作系统后

<img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202305101640421.png" alt="image-20230510164050355" style="zoom: 67%;" />

* 如果安装完操作系统，你的磁盘里边就有可能是这个样子。 先看后面这些部分cdef盘，操作系统是安装在C盘里的。除了你能看得见的这些磁盘分区之外。在磁盘的开头的位置会留出一片区域，这片区域用于存储主引导记录，英文缩写叫MBR，这里边主要包含了两个重要的东西，首先是磁盘引导程序。其次是分区表，这个分区表其实就是一个数据结构，这个数据结构里边说明了在你的这个磁盘当中，每一个盘每一个分区分别占多大的空间以及每个分区的地址范围。
* 接下来看一下C盘里边长什么样，首先C盘安装了操作系统并且会使用C盘来启动操作系统，在这种情况下就可以把C盘称为磁盘的活动分区再把C盘内部进步细分。

<img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202305101645628.png" alt="image-20230510164521561" style="zoom: 67%;" />

* 有两个比较特别的部分，首先有一片区域用于存储引导记录。英文缩写叫PBR，然后其次会有根目录相关的数据。 根目录就是双击打开C盘之后看见的那些东西，根目录里边有可能会包含一些文件夹，有可能会包含一些文件
* 我们已经知道了一个安装了操作系统的磁盘內部大概长什么样分为哪些部分以及C盘的内部可以分为哪些内容



## 操作系统引导（开机过程）

<img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202305101651824.png" alt="image-20230510165125733"  />

* 接下来看一下C盘里边安装的操作系统是怎么一步一步启动的，操作系统要启动，操作系统的数据肯定需要被放到主存里边
* 现在需要给大家补充一个知识。计算机的主存由RAM和ROM两个部分组成，我们平时说手机内存是多少，或者电脑内存是多少，通常说的是RAM。除了RAM之外还有这样的一个部分，这个ROM芯片被集成在电脑主板上，这个存储芯片里边存储的是BIOS，BIOS是基本输入输出系统（Basic Input/Output System）的缩写。这个基本输入输出系统，是由一系列的程序组成的，其中最重要的一个程序就是ROM引导程序。又可以称为自举程序。RAM芯片里面的数据只要一关机，一断电里面的数据就被清空了。 但是ROM芯片里面的数据是不会因为断电而丢失的，这就意味着当我们开机的时候，CPU一旦通上电，CPU就可以去主存当中固定的位置找到ROM引导程序，也就这个自举程序。然后执行这个程序里边的指令，一条一条往后执行，执行这个ROM引导程序的作用是什么呢？它会指示着CPU去把磁盘的主引导记录读入内存，主引导记录里边有分区表，同时还有一个叫做磁盘引导程序的东西，这两个东西现在都被我们读到主存里了。 接下来CPU就可以去执行主存里边的磁盘引导程序，而磁盘引导程序会根据分区表去判断C盘所处的位置，接下来就可以读入C盘的第一部分的数据，也就是读入这个PBR引导记录。这个引导记录本质上也是一个程序，接下来CPU就可以去执行引导记录里边的程序，执行这个程序的主要作用是会负责找到启动管理器，启动管理器又是另一个程序。 这个程序通常存放在根目录下面的某个位置， 所以接下来从根目录里边找到启动管理程序，然后CPU再执行启动管理程序。接下来，启动管理程序就会完成操作系统初始化的一系列的工作，所以操作系统引导的过程，大致上可以把它分为四个主要步骤。 

<img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202305101727906.png" alt="image-20230510172729782" style="zoom:80%;" />

* 第一步CPU首先从一个特定的主存地址开始去取指令，因为ROM引导程序是存储在某一个特定的位置，固定不变的，从这个位置开始，一条一条往后执行这些指令，这些指令就是ROM引导程序，通常这个ROM引导程序会先进行硬件的自检，就是检查有没有插磁盘、有没有插内存条等等，就是进行硬件的自检，所有的硬件都没有问题之后才会进行下一步，也就是刚才提到的第二步会把磁盘当中的第一块， 也就是主引导记录给读入内存，同时执行磁盘引导程序并且扫描分区表，找到活动分区，也就是安装了操作系统的分区。 只要找到了活动分区的起始地址，接下来就可以去读入这个活动分区的第一个部分的内容， 也就是引导记录。 把这个引导记录读入内存之后，就可以执行这个引导记录里边的程序，这个程序完成的事情是会从根目录下面去找到完整的操作系统初始化程序，也就是刚才提到的启动管理器。  最后再执行操作系统初始化的这个程序就可以完成一系列开机的动作，这就是操作系统引导也就是开机的过程。

* 关于操作系统引导的过程，大家结合这页PPT来理解就可以了，最后给大家拓展一个小东西

  <img src="https://cvp.oss-cn-shanghai.aliyuncs.com/picgo/202305101731008.png" alt="image-20230510173115880" style="zoom: 80%;" />

* 如果你用的是Windows操作系统的话，可以去找一下C盘下面应该会有一个叫做Windows的文件夹。 然后在这个下面会找到一个叫做Boot的文件夹在这个文件夹下面的东西就是刚才提到的操作系统初始化程序相关的内容。 所以刚才说的第四步，本质上就是要从根目录C盘的根目录出发，然后找到操作系统初始化程序，接下来再运行这一系列的程序，从而完成开机的动作。 大家在开机的时候看见你的电脑在转圈圈，正在启动，看见那个画面的时候，其实它背后执行的就是这些东西。 

* 有兴趣的同学可以自己去翻—下你的电脑，学了理论再结合实践去看一下这些东西可以让你的记忆更牢固。 也会让你对一门学
  科更有兴趣。